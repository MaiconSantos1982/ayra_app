# ğŸ—ï¸ Arquitetura Ayra SaaS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USUÃRIO FINAL                            â”‚
â”‚                                                                  â”‚
â”‚  ğŸ“± iOS (Safari)    ğŸ“± Android (Chrome)    ğŸ’» Desktop (Chrome)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ HTTPS
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AYRA PWA (Frontend)                         â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   React +    â”‚  â”‚  Service     â”‚  â”‚   Manifest   â”‚         â”‚
â”‚  â”‚   Vite       â”‚  â”‚  Worker      â”‚  â”‚   + Icons    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚              PÃGINAS PRINCIPAIS                       â”‚      â”‚
â”‚  â”‚                                                        â”‚      â”‚
â”‚  â”‚  â€¢ AuthPage (Login)                                   â”‚      â”‚
â”‚  â”‚  â€¢ DashboardSimple (InÃ­cio)                          â”‚      â”‚
â”‚  â”‚  â€¢ RegisterSimple (Registro de RefeiÃ§Ãµes)            â”‚      â”‚
â”‚  â”‚  â€¢ AnamnesePage (Dados Pessoais + Dieta)            â”‚      â”‚
â”‚  â”‚  â€¢ MetasPage (Metas Nutricionais)                    â”‚      â”‚
â”‚  â”‚  â€¢ RegistroDiarioPage (Lifestyle)                    â”‚      â”‚
â”‚  â”‚  â€¢ Chat (Conversa com Ayra IA)                       â”‚      â”‚
â”‚  â”‚  â€¢ ProfileSimple (Perfil)                            â”‚      â”‚
â”‚  â”‚  â€¢ AdminPage (Painel Admin) ğŸ”’                       â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ API Calls
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SUPABASE (Backend)                          â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    AUTHENTICATION                         â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â€¢ Email Auth (Magic Link / OTP)                         â”‚  â”‚
â”‚  â”‚  â€¢ Session Management                                     â”‚  â”‚
â”‚  â”‚  â€¢ JWT Tokens                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    DATABASE (PostgreSQL)                  â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  ğŸ“Š TABELAS:                                              â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚
â”‚  â”‚  â”‚  ayra_cadastro      â”‚  â”‚  ayra_perfil        â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ id (PK)          â”‚  â”‚  â€¢ id (PK)          â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ email            â”‚  â”‚  â€¢ id_usuario (FK)  â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ premium          â”‚  â”‚  â€¢ nome             â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ created_at       â”‚  â”‚  â€¢ idade            â”‚       â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â€¢ peso             â”‚       â”‚  â”‚
â”‚  â”‚                            â”‚  â€¢ altura           â”‚       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â€¢ objetivo         â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  ayra_metas         â”‚  â”‚  â€¢ restricoes       â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ id (PK)          â”‚                                 â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ id_usuario (FK)  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ calorias         â”‚  â”‚  ayra_dieta_        â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ proteina         â”‚  â”‚  personalizada      â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ carboidrato      â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ gordura          â”‚  â”‚  â€¢ id (PK)          â”‚       â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â€¢ id_usuario (FK)  â”‚       â”‚  â”‚
â”‚  â”‚                            â”‚  â€¢ tipo             â”‚       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â€¢ horario          â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  ayra_refeicoes     â”‚  â”‚  â€¢ descricao        â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ id (PK)          â”‚                                 â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ id_usuario (FK)  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ tipo             â”‚  â”‚  ayra_diario_       â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ descricao        â”‚  â”‚  lifestyle          â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ foto_url         â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ data_hora        â”‚  â”‚  â€¢ id (PK)          â”‚       â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â€¢ id_usuario (FK)  â”‚       â”‚  â”‚
â”‚  â”‚                            â”‚  â€¢ agua_ml          â”‚       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â€¢ exercicio        â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  ayra_notificacoes  â”‚  â”‚  â€¢ sono             â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚  â”‚  â€¢ humor            â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ id (PK)          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ id_usuario (FK)  â”‚                                 â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ tipo             â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ titulo           â”‚  â”‚  ayra_push_tokens   â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ mensagem         â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ lida             â”‚  â”‚  â€¢ id (PK)          â”‚       â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â€¢ id_usuario (FK)  â”‚       â”‚  â”‚
â”‚  â”‚                            â”‚  â€¢ token            â”‚       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â€¢ plataforma       â”‚       â”‚  â”‚
â”‚  â”‚  â”‚  ayra_admins        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚                                 â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ id (PK)          â”‚                                 â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ email            â”‚                                 â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ role             â”‚                                 â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  ğŸ”’ ROW LEVEL SECURITY (RLS) ativado em todas as tabelas â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    STORAGE (Arquivos)                     â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  ğŸ“ Bucket: ayra-meal-photos                             â”‚  â”‚
â”‚  â”‚     â””â”€â”€ {user_id}/                                        â”‚  â”‚
â”‚  â”‚         â”œâ”€â”€ {timestamp}_1.jpg                            â”‚  â”‚
â”‚  â”‚         â”œâ”€â”€ {timestamp}_2.jpg                            â”‚  â”‚
â”‚  â”‚         â””â”€â”€ ...                                           â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  ğŸ”’ PolÃ­ticas de acesso por usuÃ¡rio                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  EDGE FUNCTIONS (Serverless)              â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  âš¡ send-to-ai                                            â”‚  â”‚
â”‚  â”‚     â€¢ Coleta dados do usuÃ¡rio                            â”‚  â”‚
â”‚  â”‚     â€¢ Formata JSON                                        â”‚  â”‚
â”‚  â”‚     â€¢ Envia para API da IA                               â”‚  â”‚
â”‚  â”‚     â€¢ Retorna resposta                                    â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  âš¡ send-notification                                      â”‚  â”‚
â”‚  â”‚     â€¢ Envia notificaÃ§Ã£o individual                        â”‚  â”‚
â”‚  â”‚     â€¢ Envia broadcast (todos)                            â”‚  â”‚
â”‚  â”‚     â€¢ Agenda notificaÃ§Ãµes                                 â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  âš¡ schedule-reminders                                     â”‚  â”‚
â”‚  â”‚     â€¢ Cron job para lembretes automÃ¡ticos                â”‚  â”‚
â”‚  â”‚     â€¢ Beber Ã¡gua, registrar refeiÃ§Ãµes, etc               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ API Calls
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SERVIÃ‡OS EXTERNOS                             â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  FIREBASE            â”‚  â”‚  AYRA IA API         â”‚            â”‚
â”‚  â”‚  Cloud Messaging     â”‚  â”‚  (Seu backend de IA) â”‚            â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚            â”‚
â”‚  â”‚  â€¢ Push Notificationsâ”‚  â”‚  â€¢ Processamento IA  â”‚            â”‚
â”‚  â”‚  â€¢ Token Management  â”‚  â”‚  â€¢ AnÃ¡lise de dados  â”‚            â”‚
â”‚  â”‚  â€¢ Delivery Reports  â”‚  â”‚  â€¢ RecomendaÃ§Ãµes     â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  ANALYTICS           â”‚  â”‚  ERROR TRACKING      â”‚            â”‚
â”‚  â”‚  (Google/Plausible)  â”‚  â”‚  (Sentry)            â”‚            â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚            â”‚
â”‚  â”‚  â€¢ MÃ©tricas de uso   â”‚  â”‚  â€¢ Logs de erros     â”‚            â”‚
â”‚  â”‚  â€¢ ConversÃµes        â”‚  â”‚  â€¢ Performance       â”‚            â”‚
â”‚  â”‚  â€¢ RetenÃ§Ã£o          â”‚  â”‚  â€¢ Debugging         â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Fluxo de Dados Principais

### 1. Login do UsuÃ¡rio
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UsuÃ¡rio â”‚â”€â”€â”€â”€â–¶â”‚ AuthPage â”‚â”€â”€â”€â”€â–¶â”‚ Supabase â”‚â”€â”€â”€â”€â–¶â”‚ Database â”‚
â”‚ digita  â”‚     â”‚ envia    â”‚     â”‚ Auth     â”‚     â”‚ cadastro â”‚
â”‚ email   â”‚     â”‚ email    â”‚     â”‚ valida   â”‚     â”‚ cria/    â”‚
â”‚         â”‚     â”‚          â”‚     â”‚          â”‚     â”‚ atualiza â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚                  â”‚
                      â”‚                  â”‚ JWT Token
                      â”‚                  â–¼
                      â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Session  â”‚
                      â”‚            â”‚ criada   â”‚
                      â–¼            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Dashboardâ”‚
                â”‚ (InÃ­cio) â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Registro de RefeiÃ§Ã£o
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UsuÃ¡rio â”‚â”€â”€â”€â”€â–¶â”‚ Register â”‚â”€â”€â”€â”€â–¶â”‚ Supabase â”‚â”€â”€â”€â”€â–¶â”‚ Database â”‚
â”‚ preencheâ”‚     â”‚ Simple   â”‚     â”‚ Storage  â”‚     â”‚ refeicoesâ”‚
â”‚ dados + â”‚     â”‚          â”‚     â”‚ (foto)   â”‚     â”‚          â”‚
â”‚ foto    â”‚     â”‚          â”‚     â”‚          â”‚     â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚                  â”‚
                      â”‚                  â”‚ URL da foto
                      â”‚                  â–¼
                      â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Salva    â”‚
                      â”‚            â”‚ registro â”‚
                      â–¼            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Toast    â”‚
                â”‚ Sucesso  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Envio de Dados para IA
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UsuÃ¡rio â”‚â”€â”€â”€â”€â–¶â”‚ Chat     â”‚â”€â”€â”€â”€â–¶â”‚ Edge     â”‚â”€â”€â”€â”€â–¶â”‚ Ayra IA  â”‚
â”‚ clica   â”‚     â”‚ coleta   â”‚     â”‚ Function â”‚     â”‚ API      â”‚
â”‚ "Enviar"â”‚     â”‚ dados    â”‚     â”‚ formata  â”‚     â”‚ processa â”‚
â”‚         â”‚     â”‚          â”‚     â”‚ JSON     â”‚     â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚                  â”‚              â”‚
                      â”‚                  â”‚              â”‚
                      â”‚                  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚                  â”‚ Resposta IA
                      â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Exibe    â”‚
                â”‚ resposta â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. NotificaÃ§Ã£o Push
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cron Jobâ”‚â”€â”€â”€â”€â–¶â”‚ Edge     â”‚â”€â”€â”€â”€â–¶â”‚ Firebase â”‚â”€â”€â”€â”€â–¶â”‚ UsuÃ¡rio  â”‚
â”‚ ou Adminâ”‚     â”‚ Function â”‚     â”‚ FCM      â”‚     â”‚ recebe   â”‚
â”‚ trigger â”‚     â”‚ busca    â”‚     â”‚ envia    â”‚     â”‚ notif.   â”‚
â”‚         â”‚     â”‚ tokens   â”‚     â”‚          â”‚     â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚                  â”‚
                      â”‚                  â”‚
                      â–¼                  â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Database â”‚       â”‚ Service  â”‚
                â”‚ salva    â”‚       â”‚ Worker   â”‚
                â”‚ registro â”‚       â”‚ exibe    â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” SeguranÃ§a

### Row Level Security (RLS)
```sql
-- Exemplo: UsuÃ¡rio sÃ³ vÃª suas prÃ³prias refeiÃ§Ãµes
CREATE POLICY "Users can view own meals" 
ON ayra_refeicoes
FOR SELECT 
USING (auth.uid() = id_usuario);

-- Exemplo: Apenas admins podem ver todos os usuÃ¡rios
CREATE POLICY "Admins can view all users" 
ON ayra_cadastro
FOR SELECT 
USING (
  EXISTS (
    SELECT 1 FROM ayra_admins 
    WHERE email = auth.email()
  )
);
```

### ProteÃ§Ã£o de Rotas
```typescript
// Frontend - ProtectedRoute.tsx
if (!user) {
  return <Navigate to="/login" />;
}

// Admin routes
if (isAdminRoute && !isAdmin) {
  return <Navigate to="/" />;
}
```

---

## ğŸ“Š Escalabilidade

### OtimizaÃ§Ãµes Implementadas
- âœ… Lazy loading de componentes
- âœ… Code splitting por rota
- âœ… Cache de assets estÃ¡ticos (Service Worker)
- âœ… CompressÃ£o de imagens
- âœ… PaginaÃ§Ã£o de dados

### Limites Atuais (Supabase Free Tier)
- 500 MB de database
- 1 GB de storage
- 2 GB de bandwidth/mÃªs
- 50,000 usuÃ¡rios ativos/mÃªs

### Quando Escalar
- **Database:** Quando atingir 400 MB â†’ Upgrade para Pro ($25/mÃªs)
- **Storage:** Quando atingir 800 MB â†’ Upgrade ou CDN externo
- **UsuÃ¡rios:** Quando atingir 40k ativos â†’ Upgrade ou otimizar queries

---

## ğŸš€ Deploy

### Plataformas Recomendadas
1. **Vercel** (Recomendado)
   - Deploy automÃ¡tico via Git
   - SSL grÃ¡tis
   - Edge Functions
   - Analytics incluÃ­do

2. **Netlify**
   - Similar ao Vercel
   - Bom para PWA
   - Forms integrados

3. **Cloudflare Pages**
   - Mais rÃ¡pido (CDN global)
   - GrÃ¡tis ilimitado
   - Workers para Edge Functions

### VariÃ¡veis de Ambiente (Production)
```env
VITE_SUPABASE_URL=https://seu-projeto.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGc...
VITE_FIREBASE_API_KEY=AIzaSy...
VITE_FIREBASE_PROJECT_ID=ayra-prod
VITE_AI_API_URL=https://api.ayra.ai
```

---

## ğŸ“ˆ Monitoramento

### MÃ©tricas Importantes
- **Performance:** Lighthouse score > 90
- **Uptime:** > 99.5%
- **Erro rate:** < 1%
- **Tempo de resposta:** < 500ms (p95)

### Ferramentas
- **Sentry:** Tracking de erros
- **Google Analytics:** MÃ©tricas de uso
- **Supabase Dashboard:** Database performance
- **Vercel Analytics:** Web vitals

---

Esta arquitetura Ã©:
- âœ… **EscalÃ¡vel:** Suporta crescimento gradual
- âœ… **Segura:** RLS + JWT + HTTPS
- âœ… **Moderna:** PWA + Edge Functions
- âœ… **EconÃ´mica:** Free tier para comeÃ§ar
- âœ… **ManutenÃ­vel:** CÃ³digo organizado e documentado
